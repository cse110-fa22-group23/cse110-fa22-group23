<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>window.addEventListener("DOMContentLoaded", init);
var data = {};
var count = 1;
var currRow;
//var currMax = [];

/**
 * Callback function to run when DOM is loaded. Loads and renders data from localStorage.
 * @return 0 (int)
 */
function init() {
    // load data from localStorage if it exists
    if (!(localStorage.getItem("SpreadSheet") === null)) {
        var loadedData = window.localStorage.getItem("SpreadSheet");
        loadedData = JSON.parse(loadedData);
        addEntrys(loadedData);

        data = loadedData;
        console.log(loadedData);
    }
    if (!(localStorage.getItem("counter") === null)) {
        var counter = window.localStorage.getItem("counter");
        count = JSON.parse(counter);
    }
    return 0;
}

/**
 * Makes the form modal visible on the page.
 */
function openForm() {
    document.getElementById("form-modal").style.display = "block";
}

/**
 * Makes the form modal no longer visible on the page.
 */
function closeForm() {
    document.getElementById("form-modal").style.display = "none";
}

/**
 * Makes the form modal visible on the page.
 */
function openEditForm() {
    document.getElementById("edit-modal").style.display = "block";
}

/**
 * Makes the form modal no longer visible on the page.
 */
function closeEditForm() {
    document.getElementById("edit-modal").style.display = "none";
}

window.addEventListener("click", function (e) {
    if (e.target == document.getElementById("form-modal")) {
        closeForm();
    }
});

/**
 * Appends form data (from the modal) to a corresponding entry in the table.
 */
function addRow() {
    event.preventDefault();

    const formData = {
        company: document.getElementById("company").value,
        position: document.getElementById("position").value,
        location: document.getElementById("location").value,
        industry: document.getElementById("industry").value,
        status: document.getElementById("status").value,
        ranking: document.getElementById("ranking").value,
        deadline: document.getElementById("deadline").value,
    };

    let rowId = count;
    addEntry(formData, rowId);
    closeForm();
    save_data(rowId, formData);
}

/**
 * Edit the row given a reference to its data. Opens edit modal.
 * @param td item table data
 */
function editButton(item) {
    const row = item.closest("tr");
    currRow = row;
    const rowData = data[row.id];
    console.log(rowData["company"]);
    document.getElementById("companyEdit").value = rowData["company"];
    document.getElementById("positionEdit").value = rowData["position"];
    document.getElementById("locationEdit").value = rowData["location"];
    document.getElementById("industryEdit").value = rowData["industry"];
    document.getElementById("statusEdit").value = rowData["status"];
    document.getElementById("rankingEdit").value = rowData["ranking"];
    document.getElementById("deadlineEdit").value = rowData["deadline"];

    openEditForm();
}

/**
 *  Edit row from the data in the modal.
 */
function editRow() {
    event.preventDefault();
    const row = currRow;
    const formData = {
        company: document.getElementById("companyEdit").value,
        position: document.getElementById("positionEdit").value,
        location: document.getElementById("locationEdit").value,
        industry: document.getElementById("industryEdit").value,
        status: document.getElementById("statusEdit").value,
        ranking: document.getElementById("rankingEdit").value,
        deadline: document.getElementById("deadlineEdit").value,
    };
    deleteButton(row);
    addEntry(formData, row.id, row.rowIndex);
    closeEditForm();
    save_data(row.id, formData);
}

/**
 * Deletes the row given a reference to its data.
 * @param td item table data
 */
function deleteButton(item) {
    const row = item.closest("tr");
    // delete from HTML
    document.getElementById("spreadsheet").deleteRow(row.rowIndex);
    // delete from local storage
    console.log(data[row.id]);
    delete data[row.id];
    save_localstorage();
}

/**
 * Add multiple entrys to the table.
 * @param entrys array of entrys
 */
function addEntrys(entrys) {
    console.log("addEntrys");
    for (var key in entrys) {
        addEntry(entrys[key], key);
    }
}

/**
 * Appends form data (from the modal) to a corresponding entry in the table.
 * @param entry a dictionary of a job application data
 */
function addEntry(entry, id, rowIndex = 1) {
    var table = document.getElementById("spreadsheet");
    var row = table.insertRow(rowIndex);
    row.id = id;
    var company = row.insertCell(0);
    company.setAttribute("class", "company_name");
    var position = row.insertCell(1);
    position.setAttribute("class", "position_name");
    var location = row.insertCell(2);
    location.setAttribute("class", "location_name");
    var industry = row.insertCell(3);
    industry.setAttribute("class", "industry_name");
    var status = row.insertCell(4);
    status.setAttribute("class", "status_name");
    var ranking = row.insertCell(5);
    ranking.setAttribute("class", "ranking_value");
    var deadline = row.insertCell(6);
    deadline.setAttribute("class", "deadline_date");
    var editButton = row.insertCell(7);
    var deleteButton = row.insertCell(8);
    company.innerHTML = entry["company"];
    position.innerHTML = entry["position"];
    location.innerHTML = entry["location"];
    industry.innerHTML = entry["industry"];
    status.innerHTML = entry["status"];
    if (status.innerHTML == "Applied") {
        status.setAttribute("class", "applied");
    } else if (status.innerHTML == "In Progress") {
        status.setAttribute("class", "in_progress");
    } else if (status.innerHTML == "Not Started") {
        status.setAttribute("class", "not_started");
    }
    ranking.innerHTML = `&lt;img src="/cse110-fa22-group23/admin/source/assets/images/stars/${entry["ranking"]}-star.svg" alt="${entry["ranking"]} stars">&lt;/img>`;
    deadline.innerHTML = entry["deadline"];
    editButton.innerHTML = `&lt;button type="button" id="createBtn" onclick="editButton(this)">Edit&lt;/button>`;
    deleteButton.innerHTML = `&lt;button type="button" id="createBtn" onclick="deleteButton(this)">Delete&lt;/button>`;
    count++;
}

/**
 * Saves form data (from the modal) to local storage.
 */
function save_data(id, formData) {
    data[id.toString()] = formData;

    save_localstorage();
}

function save_localstorage() {
    window.localStorage.setItem("SpreadSheet", JSON.stringify(data));
    window.localStorage.setItem("counter", JSON.stringify(count));
}

// To be used in tests
module.exports = {
    init,
    openForm,
    closeForm,
    addRow,
    save_data,
    addEntry,
    deleteButton,
    editButton,
    editRow,
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addEntry">addEntry</a></li><li><a href="global.html#addEntrys">addEntrys</a></li><li><a href="global.html#addRow">addRow</a></li><li><a href="global.html#closeEditForm">closeEditForm</a></li><li><a href="global.html#closeForm">closeForm</a></li><li><a href="global.html#deleteButton">deleteButton</a></li><li><a href="global.html#editButton">editButton</a></li><li><a href="global.html#editRow">editRow</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#openEditForm">openEditForm</a></li><li><a href="global.html#openForm">openForm</a></li><li><a href="global.html#save_data">save_data</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Mon Nov 21 2022 15:27:32 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
